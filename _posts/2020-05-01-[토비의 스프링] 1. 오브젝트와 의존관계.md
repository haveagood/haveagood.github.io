# [토비의 스프링] 1. 오브젝트와 의존관계

스프링이 자바에서 가장 중요하게 가치를 두는 것은 객체지향 프로그래밍이 가능한 언어라는 부분

때문에, 스프링이 가장 관심을 많이 두는 대상은 오브젝트 이다. 스프링은 객체지향 설계와 구현에 관해 특정한 모델과 기법을 억지로 강요하지는 않는다. 하지만, 오브젝트를 어떻게 설계, 구현, 사용, 개선하는지에 대한 기준을 마련해준다.

## 1. DAO

> DAO
>
> Data Access Object 는 DB를 사용해 데이터를 조회하거나, 조작하는 기능을 전담하도록 만든 오브젝트

> Java Bean
>
> 처음 시작은 비주얼 툴에서 조작 가능한 컴포넌트를 지칭했지만, 최근에는 두가지 관례를 따라서 만든 오브젝트를 지칭한다.
>
> 1.  디폴트 생성자 : 자바빈은 파라미터가 없는 디폴트 생성자를 가지고 있어야 한다. 툴이나 프레임워크에서 리플렉션을 이용해 오브젝트를 생성하기 때문에 필요하다.
> 2. 프로퍼티 : 자바빈이 노출하는 이름을 가진 속성을 프로퍼티 라고 한다. 프로퍼티는 set으로 시작하는 setter 메소드와 get으로 시작하는 getter 메소드를 이용해 수정 또는 조회할 수 있다.

JDBC를 이용해서 작업을 한다면, 일반적인 순서는 다음과 같다.

- DB연결을 위한 Connection을 가져온다.
- SQL을 담은 Statement(or PreparedStatement)를 만든다.
- 만들어진 Statement를 실행한다.
- 조회의 경우 SQL 쿼리의 실행 결과를 ResultSet으로 받아서 정보를 저장할 오브젝트에 옴겨준다.
- 작업 중에 생성된 Connection, Statement, ResultSet과 같은 리소스는 작업을 마치고 반드시 닫아준다.
- JDBC API가 만들어내는 예외를 잡아서 직접 처리하거나, throws 선언을 해서 메소드 밖으로 던지게 한다.

일단, 예외는 모두 메소드 밖으로 던지는 편이 간단하다.

토비의 스프링 책에서는 UserDao , User클래스를 우선 분리했다. UserDao에서 add , get 메소드를 만들고, 각각 connection, statement를 만들어서, 실행하고, 닫아줬다.

## 2. DAO의 분리



### 1. 관심사의 분리

객체지향의 세계에서는 모든것이 변한다. 변수나 오브젝트의 필드값이 변하는 것이 아니라, 오브젝트에 대한 설계와 이를 구현한 코드가 변한다는 뜻이다. 사용자의 요구가 끊임없이 바뀌고 발전하기 때문이다.

개발자가 객체를 설계할 때, 염두에 둬야 할 사항은 미래의 변화를 대비하는 것이다. 객체지향 기술은 변화에 효과적으로 대응할 수 있는 기술적인 특징이 있다.

프로그래밍의 기초 개념중, 관심사의 분리라는 것이 있다. 관심이 같은것 끼리는 하나의 객체 안으로 또는 친한 객체로 모이게 하고, 관심이 다른 것은 가능한 따로 떨어져서 영향을 주지 않도록 분리하는것이다.

### 2. 커넥션 만들기의 추출

UserDao 에서 구현된 메소드를 보면, add()메소드 하나에서도 세가지 관심사를 분리할 수 있다.

- DB와 연결을 위한 커넥션을 가져오는 관심사
- 사용자 등록을 위해 DB에 보낼 SQL문장을 담을 Statement를 만들고 실행하는 관심사
- 작업이 끝나면, statement, connection 오브젝트를 닫아주는 관심사

기존의 UserDao의 경우에는 예외상황에 대한 처리가 전혀 없다는 문제도 존재하지만, 1.2장에서는 넘어간다.

#### 중복 코드의 메소드 추출

각 관심사 별로 중복되는 코드를 별도의 메소드로 추출하여 활용한다.