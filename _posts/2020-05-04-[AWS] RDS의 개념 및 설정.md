# AWS RDS 활용



## AWS RDS란?

AWS RDS는 아마존 관계형 데이터베이스 서비스(Amazon Relation Database Service)이다. 아마존에서 서비스하는 분산 관계형 데이터베이스 이다. 어플리케이션 내부에서 관계형 데이터베이스의 설정, 운영, 스케일링을 단순화 할 수 있도록 설계된 클라우드 상에서 동작하는 웹 서비스 이다. 또한, EC2와 마찬가지로 750h/month 의 프리티어 사용이 가능하다.

AWS RDS는 인프라 및 데이터베이스 업데이트를 관리해주는 것 뿐만 아니라, 까다로운 관계형 데이터베이스의 설치, 운영 관리를 지원하는 서비스 이다.

## RDS 지원 범위

현재, MySQL, Oracle, SQL Server, PostgreSQL, MariaDB, Aurora 총 6가지의 데이터베이스 엔진을 지원하고 있다.

데이터베이스의 크기는 1. m4(기본) 2. r3(메모리 최적화) 3. t2(마이크로), 총 3가지 카테고리로 나뉜다. 최적화된 I/O를 실현할 수 있도록 각 그룹마다 특성에 맞게 vCPUs, GiBs 메모리, 네트워크 성능 수준이 설정되어 있다.

각 RDS 인스턴스에서 "Multi-AZ" 옵션을 설정하면, 다른 가용영역(Availability Zone)에 복제된 데이터베이스를 필요할 때, 바로 사용할 수 있다. 이를 활용하는 이유는, 한쪽 가용영역에서 장애 및 에러가 발생할 경우, 문제에 영향을 받지 않게 독립된 다른 가용영역에 미리 복제된 데이터베이스를 자동으로 사용해서 복구(Failover) 시키는 기능이다.

Aurora는 Amazon에서 제공하는 자체 데이터베이스 이다. 장애 발생에도 더 안전하고, 가용영역을 통해 자체 복구가 가능하며, 추가적인 퍼포먼스 기능들을 제공하고 있다.

## EC2에 DB를 직접 설치 VS RDS 활용

Amazon에서 DB를 활용할 수 있는 방안은 두가지 이다. 1.EC2 인스턴스에 직접 데이터베이스를 설치하여 활용, 2.RDS를 활용

> EC2는 내가 직접 리눅스 위에 사용하려는 DB를 설치하고, 그 위에서 서비스 하는 것이다. RDS는 주로 EC2와 함께 사용하며, 아마존에서 DB설정, 운영, 백업 등의 기능을 편리하게 이용할 수 있게 해주는 EC2와는 분리된 DB 전용 서버이다.

가격적인 측면을 고려했을 때는 EC2 인스턴스에 데이터베이스를 직접 설치하는것이 훨씬 더 저렴하다. 그럼에도 불구하고 RDS가 고려되는 이유는 빠른 시간 내에 가치를 이룸으로써 생기는 비용 절감이다. OS 및 데이터베이스의 설치 및 관리, 업데이트를 할 필요가 없다. 또한 AWS 콘솔이나 AWS API를 통해서 손쉽게 백업이나 복구가 가능해진다.



## RDS 생성하기

### 1. RDS Console Page 이동

<img width="980" alt="스크린샷 2020-05-04 오후 1 19 34" src="https://user-images.githubusercontent.com/42365037/80936757-6fd26580-8e0d-11ea-82cf-99d9ef29811c.png">

AWS Console 창에서 RDS를 검색해서 들어간다.

### 2. 데이터 베이스 생성

<img width="890" alt="스크린샷 2020-05-04 오후 1 21 03" src="https://user-images.githubusercontent.com/42365037/80936776-88428000-8e0d-11ea-8c0b-b7699b028ad2.png">

화면 중앙에 데이터베이스 생성 버튼을 클릭한다.

### 3. 데이터 베이스 설정

<img width="782" alt="스크린샷 2020-05-04 오후 1 22 43" src="https://user-images.githubusercontent.com/42365037/80936793-9a242300-8e0d-11ea-92af-9048e6fd2567.png">

원하는 엔진을 선택하고 데이터베이스를 생성한다. 현재, 프로젝트에서는 MySQL을 사용하려고 한다.

<img width="772" alt="스크린샷 2020-05-04 오후 1 23 47" src="https://user-images.githubusercontent.com/42365037/80936806-a7d9a880-8e0d-11ea-9505-e15f76d1dd99.png">

원하는 MySQL 버전을 선택하여준다. 나는 Default 버전을 활용하였다.

### 4. DB 인스턴스 클래스 설정 (중요 : 과금 정책과 관련되어있다.)

<img width="780" alt="스크린샷 2020-05-04 오후 1 25 32" src="https://user-images.githubusercontent.com/42365037/80936813-b3c56a80-8e0d-11ea-9221-5123851eeca6.png">

DB 인스턴스를 설정하여야 하는데, 프로덕션과 개발/테스트는 과금이 된다. 때문에, 무료 사용자라면 프리티어를 선택하여 과금을 피하도록 한다.

<img width="776" alt="스크린샷 2020-05-04 오후 1 27 00" src="https://user-images.githubusercontent.com/42365037/80936838-c50e7700-8e0d-11ea-9784-ffb5700355ea.png">

DB 인스턴스의 이름, root 계정을 설정하도록 한다.

<img width="780" alt="스크린샷 2020-05-04 오후 1 28 08" src="https://user-images.githubusercontent.com/42365037/80936844-c8a1fe00-8e0d-11ea-9550-f03b2a0dcb92.png">

DB 인스턴스의 크기 및 성능을 선택할 수 있다. DB의 성능은 대략 다음과 같다.

<img width="402" alt="스크린샷 2020-05-04 오후 1 28 35" src="https://user-images.githubusercontent.com/42365037/80936846-c93a9480-8e0d-11ea-88d3-0b4f7dbd415b.png">

하지만, 프리티어의 경우 db.t2.micro만 사용할 수 있도록 되어있다.

<img width="770" alt="스크린샷 2020-05-04 오후 1 30 57" src="https://user-images.githubusercontent.com/42365037/80936847-c9d32b00-8e0d-11ea-8994-b47557062d3a.png">

DB의 용량을 설정 할 수 있는데, 기본값으로 활용하도록 하자, 변경할 경우 과금이 될 가능성이 존재하기 때문이다.

<img width="768" alt="스크린샷 2020-05-04 오후 1 33 57" src="https://user-images.githubusercontent.com/42365037/80936848-c9d32b00-8e0d-11ea-8d67-810bf298a0bb.png">

다음으로, 다중 AZ 설정이다. AZ 설정을 하게 되면 DB에 오류가 생겨도 해당 DB와 같은 설정의 복제된 DB를 생성할 수 있어서 안정성이 올라간다는 장점이 존재하지만, 대기중인 인스턴스를 생성하게 되므로, 비용이 발생하게 된다. 물론 프리티어에서는 비활성화된 기능이다.

여기까지가 기본적인 RDS 데이터베이스 설정이다. 이 다음부터는 DB의 고급설정 기능이다. 고급 설정에서는 네트워크/보안, 백업, 암호화 등에 대한 설정이 존재한다.

<img width="768" alt="스크린샷 2020-05-04 오후 1 33 57" src="https://user-images.githubusercontent.com/42365037/80936848-c9d32b00-8e0d-11ea-8d67-810bf298a0bb.png">

데이터 베이스를 접속하는데 필요한 VPC, 인증 방식에 대한 설정을 할 수 있다. 아직은 잘 모르니까 기본 설정으로 진행하였다.
